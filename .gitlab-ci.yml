image: docker:latest
services:
 - docker:dind

stages:
 - cleanup
 - deploy

clean-dockers:
  stage: cleanup
  script:
    - docker kill $(docker ps -aq) || true
    - docker rm $(docker ps -aq) || true

deploy-backend-frontend:
 stage: deploy
 script:
  - docker build --tag "backend" Project/Backend
  - docker run -p 8000:8000 -d backend
  - docker build --tag "frontend" Project/Frontend/Mapper
  - docker run -p 8800:80 -d frontend

